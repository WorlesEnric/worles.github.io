<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>Qihang's site</title>
 <link href="http://localhost:4000/atom.xml" rel="self"/>
 <link href="http://localhost:4000/"/>
 <updated>2024-04-16T18:40:19+08:00</updated>
 <id>http://localhost:4000</id>
 <author>
   <name>Qihang Wang</name>
   <email>worlesenric@gmail.com</email>
 </author>

 
 <entry>
   <title>Finetuning Your LLM - My Workflow</title>
   <link href="http://localhost:4000/2024/04/15/finetunellm"/>
   <updated>2024-04-15T00:00:00+08:00</updated>
   <id>http://localhost:4000/2024/04/15/FinetuneLLM</id>
   <content type="html">
</content>
 </entry>
 
 <entry>
   <title>DL Development Environment 1 &gt; System Installation and Configuration</title>
   <link href="http://localhost:4000/2024/04/14/ubuntuinstallation"/>
   <updated>2024-04-14T00:00:00+08:00</updated>
   <id>http://localhost:4000/2024/04/14/UbuntuInstallation</id>
   <content type="html">&lt;h1 id=&quot;table-of-contents&quot;&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#table-of-contents&quot;&gt;Table of Contents&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#os-installation-&quot;&gt;OS Installation &lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#preparing-ubuntu-image-&quot;&gt;Preparing Ubuntu Image &lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#os-configuration&quot;&gt;OS Configuration&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#gpu-related-configuration-&quot;&gt;GPU Related Configuration &lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;os-installation-&quot;&gt;OS Installation &lt;a name=&quot;osinstallation&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;You need:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;A laptop or PC with at least 25GB of storage space.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A flash drive (12GB or above recommended).&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;preparing-ubuntu-image-&quot;&gt;Preparing Ubuntu Image &lt;a name=&quot;preparation&quot;&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Download the image from &lt;a href=&quot;https://ubuntu.com/download/desktop&quot;&gt;here&lt;/a&gt;. We use the Ubuntu 22.04 LTS for this guide.&lt;/p&gt;

&lt;p&gt;Staying consistent to the official tutorial, we use &lt;a href=&quot;https://etcher.balena.io/&quot;&gt;balenaEtcher&lt;/a&gt; to create the bootable USB stick. Do the following on balenaEtcher:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Select your downloaded ISO&lt;/li&gt;
  &lt;li&gt;Choose your USB flash drive&lt;/li&gt;
  &lt;li&gt;Click Flash&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You may need to modify the boot option, for this, you may hold &lt;code&gt;F12&lt;/code&gt; while the computer starts.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Notice: If you encounter the black screen after installed the Ubuntu via &lt;code&gt;try or install ubuntu&lt;/code&gt;. Here is the solution:&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;Press &lt;code&gt;e&lt;/code&gt; to enter the edit mode when the screen shows &lt;code&gt;try or install ubuntu&lt;/code&gt;.&lt;/li&gt;
    &lt;li&gt;Find &lt;code&gt;...quiet splash ---&lt;/code&gt;, delete the &lt;code&gt;---&lt;/code&gt; and add the &lt;code&gt;nomodeset&lt;/code&gt; in front of &lt;code&gt;quiet splash&lt;/code&gt;: &lt;code&gt;...nomodeset quiet splash&lt;/code&gt;.&lt;/li&gt;
    &lt;li&gt;Then press &lt;code&gt;enter&lt;/code&gt;, you should enter the installation interface after several seconds of black wait.&lt;/li&gt;
    &lt;li&gt;If you still encounter the problem after installation. Please do the same when you restart the machine. (remember to boot from your ubuntu disk insdead of the flash disk)&lt;/li&gt;
    &lt;li&gt;If you successfully login, edit &lt;code&gt;/etc/default/grub&lt;/code&gt; with &lt;code&gt;sudo&lt;/code&gt;, find &lt;code&gt;GRUB_CMDLINE_LINUX_DEFAULT=&lt;/code&gt;quiet splash&lt;code&gt;, change it to &lt;/code&gt;GRUB_CMDLINE_LINUX_DEFAULT=&lt;code&gt;quiet splash nomodeset&lt;/code&gt;.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Setting up Ubuntu installation:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Computer name: Name-PC&lt;/li&gt;
  &lt;li&gt;Name: Name&lt;/li&gt;
  &lt;li&gt;User name: name&lt;/li&gt;
  &lt;li&gt;Password:&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;os-configuration&quot;&gt;OS Configuration&lt;/h2&gt;

&lt;p&gt;Ref: &lt;a href=&quot;https://gist.github.com/amir-saniyan/b3d8e06145a8569c0d0e030af6d60bea&quot;&gt;Ubuntu 22.04 for DL&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You may update Ubuntu before further operations:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo apt update
$ sudo apt full-upgrade --yes
$ sudo apt autoremove --yes
$ sudo apt autoclean --yes
$ reboot
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can create a full-update script &lt;code&gt;~/full-update.sh&lt;/code&gt; to pack these operations:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;#!/usr/bin/env bash

if [ &quot;$EUID&quot; -ne 0 ]
  then echo &quot;Error: Please run as root.&quot;
  exit
fi

clear

echo &quot;################################################################################&quot;
echo &quot;Updating list of available packages...&quot;
echo &quot;--------------------------------------------------------------------------------&quot;
apt update
echo &quot;################################################################################&quot;
echo

echo &quot;################################################################################&quot;
echo &quot;Upgrading the system by removing/installing/upgrading packages...&quot;
echo &quot;--------------------------------------------------------------------------------&quot;
apt full-upgrade --yes
echo &quot;################################################################################&quot;
echo

echo &quot;################################################################################&quot;
echo &quot;Removing automatically all unused packages...&quot;
echo &quot;--------------------------------------------------------------------------------&quot;
apt autoremove --yes
echo &quot;################################################################################&quot;
echo

echo &quot;################################################################################&quot;
echo &quot;Clearing out the local repository of retrieved package files...&quot;
echo &quot;--------------------------------------------------------------------------------&quot;
apt autoclean --yes
echo &quot;################################################################################&quot;
echo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install the Chrome web browser by (get the deb file &lt;a href=&quot;https://www.google.com/chrome/&quot;&gt;here&lt;/a&gt;):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo dpkg -i google-chrome-stable_current_amd64.deb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install the developement tools by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo apt install build-essential pkg-config cmake cmake-qt-gui ninja-build valgrind
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install Python3 and venv by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo apt install python3 python3-wheel python3-pip python3-venv python3-dev python3-setuptools
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install Git by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo apt install git
$ git config --global user.name &quot;Name&quot;
$ git config --global user.email &quot;name@domain.com&quot;
$ git config --global core.editor &quot;gedit -s&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;gpu-related-configuration-&quot;&gt;GPU Related Configuration &lt;a name=&quot;GPU&quot;&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Now it comes to the steps for setting up NVIDIA toolkits. The process here may not align with your situation, check the NVIDIA official toturial whenever there are mistakes.&lt;/p&gt;

&lt;p&gt;Check the display hardware by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo lshw -C display
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Check CUDA and NVIDIA Driver Compatibilities&lt;/strong&gt; &lt;a href=&quot;https://docs.nvidia.com/deeplearning/cudnn/reference/support-matrix.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Check TensorFlow and CUDA Compatibilities&lt;/strong&gt; &lt;a href=&quot;https://www.tensorflow.org/install/gpu&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;https://www.tensorflow.org/install/source#gpu&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Check Torch and CUDA Campatibilities&lt;/strong&gt; &lt;a href=&quot;https://github.com/pytorch/pytorch/blob/main/RELEASE.md#release-compatibility-matrix&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Here we use CUDA 11.8, install the NVIDIA Driver by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo apt install nvidia-driver-535
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install the prerequisites:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo apt install linux-headers-$(uname -r)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Download CUDA 11.8 via:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install CUDA 11.8 by (select without driver):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo ./cuda_11.8.0_520.61.05_linux.run --override
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Setting up the environment variables:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;export PATH=$PATH:/usr/local/cuda-11.8/bin
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-11.8/lib64:/usr/local/cuda-11.8/extras/CUPTI/lib64
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Test by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ nvidia-smi
$ NVCC -v
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install cuDNN v8.6 for CUDA 11.8. Login and download the deb file &lt;a href=&quot;https://developer.nvidia.com/compute/cudnn/secure/8.6.0/local_installers/11.8/cudnn-local-repo-ubuntu2204-8.6.0.163_1.0-1_amd64.deb&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Then install by:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo dpkg -i cudnn-local-repo-ubuntu2204-8.6.0.163_1.0-1_amd64.deb
$ sudo cp /var/cudnn-local-repo-ubuntu2204-8.6.0.163/cudnn-local-FAED14DD-keyring.gpg /usr/share/keyrings/
$ sudo apt update
$ sudo apt install libcudnn8
$ sudo apt install libcudnn8-dev
$ sudo apt install libcudnn8-samples
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then reboot by &lt;code&gt;sudo reboot&lt;/code&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>DL Development Environment 2 &gt; Tools You May Need</title>
   <link href="http://localhost:4000/2024/04/14/softwares"/>
   <updated>2024-04-14T00:00:00+08:00</updated>
   <id>http://localhost:4000/2024/04/14/Softwares</id>
   <content type="html">&lt;h1 id=&quot;table-of-contents&quot;&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#table-of-contents&quot;&gt;Table of Contents&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#source-mirrors-&quot;&gt;Source Mirrors &lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#ubuntu-sources-2204-lts-jammy&quot;&gt;Ubuntu Sources (22.04 LTS jammy)&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#pypi&quot;&gt;PyPI&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#docker-ce&quot;&gt;Docker CE&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#dockerhub-mirror&quot;&gt;Dockerhub Mirror&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#proxy-&quot;&gt;Proxy &lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#visual-studio-code-&quot;&gt;Visual Studio Code &lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;source-mirrors-&quot;&gt;Source Mirrors &lt;a name=&quot;mirror&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;For users who experience the low connection qualities on certain software sources, you may consider using the source mirrors. Here we record the operations using Tsinghua Open Source Mirror (TUNA).&lt;/p&gt;

&lt;h3 id=&quot;ubuntu-sources-2204-lts-jammy&quot;&gt;Ubuntu Sources (22.04 LTS jammy)&lt;/h3&gt;

&lt;p&gt;Replace the content of &lt;code&gt;/etc/apt/sources.list&lt;/code&gt; with:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse
# deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse
deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
# deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse
# deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse

deb http://security.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse
# deb-src http://security.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse

# deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse
# # deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;pypi&quot;&gt;PyPI&lt;/h3&gt;

&lt;p&gt;For the temporary usage, you may directly use:
&lt;code&gt;pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Set as default, you may use:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;python -m pip install --upgrade pip
# use the below if you cannot upgrade
# python -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple --upgrade pip
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;docker-ce&quot;&gt;Docker CE&lt;/h3&gt;

&lt;p&gt;You can automatically install docker via:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;export DOWNLOAD_URL=&quot;http://mirrors.tuna.tsinghua.edu.cn/docker-ce&quot;
# For curl
curl -fsSL https://get.docker.com/ | sh
# for wget
wget -O- https://get.docker.com/ | sh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;OR, you can install mannually. The following commands are for Ubuntu, you can change them according to the instructions &lt;a href=&quot;https://mirrors.tuna.tsinghua.edu.cn/help/docker-ce/&quot;&gt;here&lt;/a&gt;. Uninstall the old version (if there is):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;for pkg in docker.io docker-doc docker-compose podman-docker containerd runc; do apt-get remove $pkg; done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then install the dependencies:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;apt-get update
apt-get install ca-certificates curl gnupg
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Add the repo:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg
echo \
  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] http://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu \
  &quot;$(. /etc/os-release &amp;amp;&amp;amp; echo &quot;$VERSION_CODENAME&quot;)&quot; stable&quot; | \
  tee /etc/apt/sources.list.d/docker.list &amp;gt; /dev/null
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install the docker:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;apt-get update
apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;dockerhub-mirror&quot;&gt;Dockerhub Mirror&lt;/h3&gt;

&lt;p&gt;You can use Aliyun container mirror service to accelerate the &lt;code&gt;docker pull xxx&lt;/code&gt; from docker hub.&lt;/p&gt;

&lt;h2 id=&quot;proxy-&quot;&gt;Proxy &lt;a name=&quot;proxy&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;For the similar reasons, you may want to equip your environment with a proxy. This blog shows the utilization of &lt;a href=&quot;https://github.com/wnlen/clash-for-linux&quot;&gt;clash for linux&lt;/a&gt; for this purpose. You may find other solutions via google.&lt;/p&gt;

&lt;p&gt;Download the clash via:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ git clone https://github.com/wanhebin/clash-for-linux.git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Enter the directory &lt;code&gt;cd clash-for-linux&lt;/code&gt; and edit &lt;code&gt;CLASH_URL&lt;/code&gt; by &lt;code&gt;vim .env&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Start the service via:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ sudo bash start.sh
# In a new terminal
$ source /etc/profile.d/clash.sh
$ proxy_on
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You may check if the service is correctly started:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ netstat -tln | grep -E &apos;9090|789.&apos;
tcp        0      0 127.0.0.1:9090          0.0.0.0:*               LISTEN     
tcp6       0      0 :::7890                 :::*                    LISTEN     
tcp6       0      0 :::7891                 :::*                    LISTEN     
tcp6       0      0 :::7892                 :::*   

$ env | grep -E &apos;http_proxy|https_proxy&apos;
http_proxy=http://127.0.0.1:7890
https_proxy=http://127.0.0.1:7890                 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you wang to shutdown or restart (maybe for updating configurations):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;#shuting down
sudo bash shutdown.sh
proxy_off

#restarting
sudo bash restart.sh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;clash dashboard is by default hosted on &lt;code&gt;http://192.168.0.1:9090/&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;visual-studio-code-&quot;&gt;Visual Studio Code &lt;a name=&quot;vscode&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Download the VSCode client &lt;a href=&quot;https://code.visualstudio.com/&quot;&gt;here&lt;/a&gt;, then install via &lt;code&gt;sudo apt install ./&amp;lt;file&amp;gt;.deb&lt;/code&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>DL Development Environment 3 &gt; Libararies You May Need</title>
   <link href="http://localhost:4000/2024/04/14/dllibs"/>
   <updated>2024-04-14T00:00:00+08:00</updated>
   <id>http://localhost:4000/2024/04/14/DLlibs</id>
   <content type="html">&lt;h1 id=&quot;table-of-contents&quot;&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#table-of-contents&quot;&gt;Table of Contents&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#ml-libararies-&quot;&gt;ML libararies &lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#pytorch-&quot;&gt;Pytorch &lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#tensorflow--&quot;&gt;Tensorflow  &lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ml-libararies-&quot;&gt;ML libararies &lt;a name=&quot;mllibs&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Prepare the common ML libs (you can also access them via anaconda)&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ python3 -m venv ~/venvs/ml
$ source ~/venvs/ml/bin/activate
(ml) $ pip install --upgrade pip setuptools wheel
(ml) $ pip install --upgrade numpy scipy matplotlib ipython jupyter pandas sympy nose
(ml) $ pip install --upgrade scikit-learn scikit-image
(ml) $ deactivate
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;pytorch-&quot;&gt;Pytorch &lt;a name=&quot;pytorch&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Pytorch CPU:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ python3 -m venv ~/venvs/torchcpu
$ source ~/venvs/torchcpu/bin/activate
(torchcpu) $ pip install --upgrade pip setuptools wheel
(torchcpu) $ pip install --upgrade opencv-python opencv-contrib-python
(torchcpu) $ pip install --upgrade torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cpu
(torchcpu) $ deactivate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Pytorch GPU (&lt;strong&gt;ALERT&lt;/strong&gt;: Check the CUDA and cuDNN and NVIDIA drive version Compatibilities &lt;a href=&quot;https://github.com/pytorch/pytorch/blob/main/RELEASE.md#release-compatibility-matrix&quot;&gt;here&lt;/a&gt;, and use the correct downloading name to repalce the ones below):&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ python3 -m venv ~/venvs/torchgpu
$ source ~/venvs/torchgpu/bin/activate
(torchgpu) $ pip install --upgrade pip setuptools wheel
(torchgpu) $ pip install --upgrade opencv-python opencv-contrib-python
(torchgpu) $ pip install --upgrade torch torchvision torchaudio
(torchgpu) $ deactivate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After installation, you may check the availability:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ source ~/venvs/torchgpu/bin/activate
(torchgpu) $ python
&amp;gt;&amp;gt;&amp;gt; import torch
&amp;gt;&amp;gt;&amp;gt; torch.cuda.is_available()
&amp;gt;&amp;gt;&amp;gt; exit()
(torchgpu) $ deactivate
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;tensorflow--&quot;&gt;Tensorflow  &lt;a name=&quot;pytorch&quot;&gt;&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Tensorflow CPU:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ python3 -m venv ~/venvs/tfcpu
$ source ~/venvs/tfcpu/bin/activate
(tfcpu) $ pip install --upgrade pip setuptools wheel
(tfcpu) $ pip install --upgrade opencv-python opencv-contrib-python
(tfcpu) $ pip install --upgrade tensorflow-cpu tensorboard keras
(tfcpu) $ deactivate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tensorflow GPU (similar to Pytorch, check the official &lt;a href=&quot;https://www.tensorflow.org/install/gpu&quot;&gt;tutorial&lt;/a&gt;)&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ python3 -m venv ~/venvs/tfgpu
$ source ~/venvs/tfgpu/bin/activate
(tfgpu) $ pip install --upgrade pip setuptools wheel
(tfgpu) $ pip install --upgrade opencv-python opencv-contrib-python
(tfgpu) $ pip install --upgrade tensorflow tensorboard keras
(tfgpu) $ deactivate
&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>Large Language Models - Aspects and Methods</title>
   <link href="http://localhost:4000/2024/04/13/introllm"/>
   <updated>2024-04-13T00:00:00+08:00</updated>
   <id>http://localhost:4000/2024/04/13/IntroLLM</id>
   <content type="html">&lt;p&gt;This post is the note for reviewing the development of the Large Language Models (LLMs), for more detailed and rigorous text, please refer to the monographs.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; This post should not serve as an introduction text to whom may not be familiar with the deep learning methodologies, since it contains intensive personal opinions, not assured to be correct.&lt;/p&gt;

&lt;h1 id=&quot;table-of-contents&quot;&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#table-of-contents&quot;&gt;Table of Contents&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#sequence-to-sequence-learning&quot;&gt;Sequence-to-sequence Learning&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#recurrent-neural-network-and-long-short-term-memory-network&quot;&gt;Recurrent Neural Network and Long Short Term Memory Network&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;sequence-to-sequence-learning&quot;&gt;Sequence-to-sequence Learning&lt;/h2&gt;

&lt;p&gt;Despite the purpose of giving an introduction of neural language processing, we will start from reviewing  the machine translation (MT) task, for the simplicity  of the ideas – transfrom one sequence of words to another sequence of words (in some other language).  Note that in the original &lt;a href=&quot;https://arxiv.org/pdf/1409.3215.pdf&quot;&gt;paper&lt;/a&gt; written by Ilya et al., the sequence to sequence learning could be a quite generalizable concept, below are several examples of sequences:&lt;/p&gt;

&lt;p&gt;&lt;img style=&quot;display: block;&quot; class=&quot;img-fluid&quot; src=&quot;https://i.imgur.com/ZVfrUta.png&quot; alt=&quot;seq2seq.&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;small&quot;&gt;&quot;Examples of sequences&quot; by seq2seq ICML 17&apos; tutorial&lt;/p&gt;

&lt;p&gt;In my opinion, the motivation for developing the modern sequence to sequence learning methods is driven by the following two problems:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The traditional ML methods rely on the consistent input dimensions. That is to say, the model only deals with the inputs that share a constant shape.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Given the training pairs (each pair contains two sequences usually sampled from two domains), the task is essentially to match the distribution of the former to the latter. How do we model, evaluate or optimize the process?&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The first problem drives the development of recurrent neural network (RNN), while the second problem drives the architecture design of the moderm seq2seq learning models. We now briefly introduce the three important models to support the further discussion, they are RNN, LSTM, and self-attention.&lt;/p&gt;

&lt;h3 id=&quot;recurrent-neural-network-and-long-short-term-memory-network&quot;&gt;Recurrent Neural Network and Long Short Term Memory Network&lt;/h3&gt;

&lt;p&gt;We would give a short introduction of the model structures and optimization techniques, the main focus of this section remains to be the discussion in the context of sequence-to-sequence learning.&lt;/p&gt;

&lt;p&gt;In short, Recurrent Neural Network (RNN) is a kind of NN architectures in which the model computation graph is directed cyclic graph, while the Long Short Term Memory (LSTM) Network is a more complex version of the core network of RNN. Though sound intuitive, RNNs are proven to be powerful in many ways, e.g., &lt;a href=&quot;https://binds.cs.umass.edu/papers/1995_Siegelmann_Science.pdf&quot;&gt;RNNs are Turing Complete&lt;/a&gt;, &lt;a href=&quot;http://www.vetta.org/documents/Machine_Super_Intelligence.pdf&quot;&gt;RNNs are nearly intelligence-equivalent by approaching the asymptotic limit in text compression&lt;/a&gt;. To make the following introduction non-trivial, we consider the predicting-next-character task, where the model is provided a sequence of characters and is required to predict the next character in the end of the sequence. (Note: The discussion here are mainly derived from the Ph.D &lt;a href=&quot;http://www.cs.utoronto.ca/~ilya/pubs/ilya_sutskever_phd_thesis.pdf&quot;&gt;thesis&lt;/a&gt; of Ilya Sutskever).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;RNN Formulation&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;There are two perspectives on RNN, view it as a single network whose computation graph is cyclic, or view it as a super deep neural network with shared weights among the blocks (unrolled view).&lt;/p&gt;

&lt;p&gt;&lt;img style=&quot;display: block;&quot; class=&quot;img-fluid&quot; src=&quot;https://i.imgur.com/ELw9Iu9.png&quot; alt=&quot;RNN.&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;small&quot;&gt;&quot;An unrolled RNN&quot; by colah&apos;s blog&lt;/p&gt;

&lt;p&gt;My apology for the inconsistency, but we are going to use a slightly different notation from the figure. Let $i_t$ be the input at t-th moment, and $o_t$ be the output at t-th moment. Aparently RNN utilizes a hidden representation of the data, denoted by $h_t$. Now we define the input-output map as:&lt;/p&gt;

\[o_t = g(h^o_t) \\
h^o_t = W_{oh}h_t + b_o \\
h_t = f(h^i_t) \\
h^i_t = W_{hi}i_t + W_{hh}h_{t-1} + b_h\]

&lt;p&gt;If you are familiar with the feed forward network, these are just two dense layers connected by the corresponding activation functions. The only difference is that the input layer takes the last moment’s state as part of the input, i.e., a combination of the input and the hidden state.&lt;/p&gt;

&lt;p&gt;Before we discuss the LSTM network, we take a glance at the ackpropagation through time algorithm (BPTT). We first define the training loss function of RNN as the cumulative loss over time:&lt;/p&gt;

\[\mathcal{L}(o, y) = \sum_{t=1}^T \mathcal{l}_t(o_t, y_t)\]

&lt;p&gt;Let’s calculate the partial derivative of the loss over $W_{hi}$ and $W_{hh}$, since the calculation w.r.t $W_{oh}$ is straight forward. We have the following:&lt;/p&gt;

\[\frac{\partial \mathcal{L}}{\partial W_{hh}} = \sum_{t=1}^T \frac{\partial \mathcal{l}_t}{\partial W_{hh}} =  \sum_{t=1}^T \frac{\partial \mathcal{l}_t}{\partial o_t}\frac{\partial o_t}{\partial h^o_t}W_{oh}\frac{\partial h_t}{\partial h^i_t}\frac{\partial h^i_t}{\partial W_{hh}} \\
\frac{\partial \mathcal{L}}{\partial W_{hi}} = \sum_{t=1}^T \frac{\partial \mathcal{l}_t}{\partial W_{hi}} =  \sum_{t=1}^T \frac{\partial \mathcal{l}_t}{\partial o_t}\frac{\partial o_t}{\partial h^o_t}W_{oh}\frac{\partial h_t}{\partial h^i_t}\frac{\partial h^i_t}{\partial W_{hi}}\]

&lt;p&gt;Note here you cannot directly calculate that $\frac{\partial h^i_t}{\partial W_{hh}}=h_{t-1}$ since $h_{t-1} = h_{t-1}(\cdot, W_{hh})$, that’s because $W_{hh}$ is shared across the whole sequence. Instead, we view the $h_t(W_{hh})$ as the composition of functions $h_t(h_{t-1}(W_{hh}), h_{t-2}(W_{hh}), … h_{1}(W_{hh}))$, applying the chain rule on the partial derivative, we have:&lt;/p&gt;

\[\frac{\partial h_t}{\partial W_{hh}}=\sum_{k=1}^t \frac{\partial h_{t}}{\partial h_{k}}\frac{\partial h_k}{W_{hh}}\]
</content>
 </entry>
 
 <entry>
   <title>Revisiting Mathematics in Deep Learning (or ML)</title>
   <link href="http://localhost:4000/2024/04/10/fundmentalmath"/>
   <updated>2024-04-10T00:00:00+08:00</updated>
   <id>http://localhost:4000/2024/04/10/fundmentalMath</id>
   <content type="html">&lt;p&gt;This post is the note for reviewing the fundamental mathematics in machine learning, especially, deep learning area. We will briefly revisit the basic concepts and useful tools in the analysis of ML algorithms.&lt;/p&gt;

&lt;p&gt;Here are some excellent materials you may find helpful:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.cis.upenn.edu/~jean/math-deep.pdf&quot;&gt;Algebra, Topology, Differential Calculus, and Optimization Theory For Computer Science and Machine Learning&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.math.uwaterloo.ca/~hwolkowi/matrixcookbook.pdf&quot;&gt;The matrix cookbook&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In fact, most of the contents in this post derive from [1].&lt;/p&gt;

&lt;h1 id=&quot;table-of-contents&quot;&gt;Table of Contents&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#table-of-contents&quot;&gt;Table of Contents&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#preliminaries&quot;&gt;Preliminaries&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#calculus&quot;&gt;Calculus&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#curves-scalar-fields-and-gradients&quot;&gt;Curves, Scalar Fields, and Gradients&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;preliminaries&quot;&gt;Preliminaries&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: This post assumes you have the preliminary knowledge of simple calculus in univariate case and linear algebra. Here provides some concepts which help us see the things in an abstract way (meaning that we then know where can or cannot we generalize our analysis to).&lt;/p&gt;

&lt;p&gt;(Derivative of the univariate scalar-valued function) A function is called &lt;em&gt;differentiable&lt;/em&gt; at a point $a$ of its domain, if its domain contains an open interval containing $a$, and the limit:
\(\lim_{h\rightarrow 0}\frac{f(a+h)-f(a)}{h}\)
exists. The $\epsilon-\delta$ definition of the derivative of $f(x)$ w.r.t its input $x$ states, $\forall \epsilon\in\mathbb{R}^+$,  $\exist\delta\in\mathbb{R}^+$, such that, $\forall |h|&amp;lt;\delta$ and $f(a+h)$ is defined, and
\(|L-\frac{f(a+h)-f(a)}{h}|&amp;lt;\epsilon\)&lt;/p&gt;

&lt;h2 id=&quot;calculus&quot;&gt;Calculus&lt;/h2&gt;

&lt;p&gt;This post assumes you have the preliminary knowledge of simple calculus in univariate case. The overall goal is to generalize the analysis on the function $f:\mathbb{R}\rightarrow\mathbb{R}$ to $f:\mathbb{R}^m\rightarrow\mathbb{R}^n$. Some useful concepts are:&lt;/p&gt;

&lt;h3 id=&quot;curves-scalar-fields-and-gradients&quot;&gt;Curves, Scalar Fields, and Gradients&lt;/h3&gt;

&lt;p&gt;The curves take the form $f:\mathbb{R}\rightarrow\mathbb{R}^n$. We could use $\mathbf{x}(t)$ to denote the curve with $\mathbf{x}\in \mathbf{R}^n$ and $t\in\mathbb{R}$. The curve is said to be &lt;em&gt;differentiable&lt;/em&gt; if as $\Delta t\rightarrow 0$, we have $\mathbf{x}(t+\Delta t)-\mathbf{x}(t)=\mathbf{x}’(t)\Delta t+\mathcal{O}(\Delta t^2)$. This serves as the definition of the derivative $\mathbf{x}’(t)$:&lt;/p&gt;

\[\frac{d\mathbf{x}}{dt}=\mathbf{x}&apos;(t)=\lim_{\Delta t\rightarrow 0}\frac{\Delta\mathbf{x}}{\Delta t}\]

&lt;p&gt;it also follows that $\frac{d}{dt}(\mathbf{g}\mathbf{h})=\frac{d\mathbf{g}}{dt}\mathbf{h}+\frac{d\mathbf{h}}{dt}\mathbf{g}$. The derivative is also called &lt;em&gt;tangent vector&lt;/em&gt; sometimes. Note that the tangent vector depends on the selection of parameter $t$, which prevents us to obtain an invariant measure of the curve. We could instead study the arc length:
\(s=\int_{t_0}^t dt&apos;|x&apos;(t&apos;)|\)
moreover, we have $\Delta s=|\Delta x|+\mathcal{O}(|\Delta x|^2)$ (as an aside, $|\cdot|$ here means the length or norm of a vector), we then have $\frac{ds}{dt}=sign(|x’|)$, where $sign(x)$ means that we need to set $x$ to be positive or negative according to whether the direction increase $t$ or not. With $s$ as our invariant parameterisation, we are able to define the induced tangent vector as $\frac{dx}{ds}$, easy to verify that the norm of this tangent vector is always 1. Similarly, the ‘invariance’ induced by the arc-length could be applied into the curvature of the curve (the second order derivative) as $\kappa(x)=\frac{d^2 x}{ds^2}$. Now curves map a scalar parameter to a vector value $x\in\mathbb{R}^n$, the scalar field does the contrary: $\phi:\mathbb{R}^n\rightarrow \mathbb{R}$. Generally we can define the vector field as $\phi:\mathbb{R}^n\rightarrow \mathbb{R}^n$. Consider the scalar field $\phi$, we could access the derivatives by its gradient: 
\(\nabla \phi=\frac{\partial\phi}{\partial x^i}\mathbf{e}^i\)
Basicly we just take derivative of $\phi$ w.r.t every coordinate, and constitute a new vector.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Building my blog</title>
   <link href="http://localhost:4000/2021/04/30/test-post-1"/>
   <updated>2021-04-30T00:00:00+08:00</updated>
   <id>http://localhost:4000/2021/04/30/test-post-1</id>
   <content type="html">&lt;p&gt;Despite there are a lot of ways to build a blog site, I utilized the jeckll academic theme and github pages to reduce the efforts. Find the commands and installation guides below:&lt;/p&gt;

&lt;h2 id=&quot;installation&quot;&gt;Installation&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ git clone https://github.com/yak-fumblepack/jekyll-academic.git
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ bundle install
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;building&quot;&gt;Building&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ bundle exec jekyll build
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Use &lt;code&gt;--verbose&lt;/code&gt; if you would like a detailed log.&lt;/p&gt;

&lt;h2 id=&quot;serving&quot;&gt;Serving&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ bundle exec jekyll serve --watch --livereload --incremental
&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 

</feed>